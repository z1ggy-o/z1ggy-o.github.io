<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TOCS'13 - Spanner: Google’s Globally Distributed Database | Gy's Blog</title>
<meta name=keywords content="distributed-systems"><meta name=description content="Motivation


Some applications need relation data model and strong consistency which BigTable cannot gives.


So, Google want to develop a system that focuses on managing cross-datacenter replicate data with database features.


Contribution


Provides a globally distributed database that shards data across many sets of Paxos state machine in datacenters.


Provide SQL-like interface, strong consistency, and high read performance.


Solution


Replication

Use Paxos to replicate data to several nodes, which provides higher availability.



Local Transactions (within a paxos group)"><meta name=author content="map[link:https://github.com/z1ggy-o name:gyzhu]"><link rel=canonical href=https://z1ggy-o.github.io/papers/2.c-2013-spanner/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://z1ggy-o.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://z1ggy-o.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://z1ggy-o.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://z1ggy-o.github.io/apple-touch-icon.png><link rel=mask-icon href=https://z1ggy-o.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://z1ggy-o.github.io/papers/2.c-2013-spanner/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload=renderMathInElement(document.body)></script><meta property="og:url" content="https://z1ggy-o.github.io/papers/2.c-2013-spanner/"><meta property="og:site_name" content="Gy's Blog"><meta property="og:title" content="TOCS'13 - Spanner: Google’s Globally Distributed Database"><meta property="og:description" content="Motivation Some applications need relation data model and strong consistency which BigTable cannot gives.
So, Google want to develop a system that focuses on managing cross-datacenter replicate data with database features.
Contribution Provides a globally distributed database that shards data across many sets of Paxos state machine in datacenters.
Provide SQL-like interface, strong consistency, and high read performance.
Solution Replication
Use Paxos to replicate data to several nodes, which provides higher availability. Local Transactions (within a paxos group)"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="papers"><meta property="article:published_time" content="2022-07-31T05:40:38+00:00"><meta property="article:modified_time" content="2024-12-28T14:09:27+08:00"><meta property="article:tag" content="Distributed-Systems"><meta name=twitter:card content="summary"><meta name=twitter:title content="TOCS'13 - Spanner: Google’s Globally Distributed Database"><meta name=twitter:description content="Motivation


Some applications need relation data model and strong consistency which BigTable cannot gives.


So, Google want to develop a system that focuses on managing cross-datacenter replicate data with database features.


Contribution


Provides a globally distributed database that shards data across many sets of Paxos state machine in datacenters.


Provide SQL-like interface, strong consistency, and high read performance.


Solution


Replication

Use Paxos to replicate data to several nodes, which provides higher availability.



Local Transactions (within a paxos group)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Papers","item":"https://z1ggy-o.github.io/papers/"},{"@type":"ListItem","position":2,"name":"TOCS'13 - Spanner: Google’s Globally Distributed Database","item":"https://z1ggy-o.github.io/papers/2.c-2013-spanner/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TOCS'13 - Spanner: Google’s Globally Distributed Database","name":"TOCS\u002713 - Spanner: Google’s Globally Distributed Database","description":"Motivation Some applications need relation data model and strong consistency which BigTable cannot gives.\nSo, Google want to develop a system that focuses on managing cross-datacenter replicate data with database features.\nContribution Provides a globally distributed database that shards data across many sets of Paxos state machine in datacenters.\nProvide SQL-like interface, strong consistency, and high read performance.\nSolution Replication\nUse Paxos to replicate data to several nodes, which provides higher availability. Local Transactions (within a paxos group)\n","keywords":["distributed-systems"],"articleBody":"Motivation Some applications need relation data model and strong consistency which BigTable cannot gives.\nSo, Google want to develop a system that focuses on managing cross-datacenter replicate data with database features.\nContribution Provides a globally distributed database that shards data across many sets of Paxos state machine in datacenters.\nProvide SQL-like interface, strong consistency, and high read performance.\nSolution Replication\nUse Paxos to replicate data to several nodes, which provides higher availability. Local Transactions (within a paxos group)\nEach Paxos group leader has a lock table to implement concurrency control.\nSpanner chooses to use 2PL as the protocol because it is designed for long-lived txns, which performs poor under optimistic protocols.\nDistributed Transactions (across paxos groups)\nEach Paxos group leader has a transaction manager to support distributed txns.\nThe transaction manager is used as a participant leader.\nSpanner uses 2PC to support distributed txns. Paxos group leaders become the coordinator and participants.\nSnapshot Isolation\nFor better read performance, Spanner uses MVCC to enable read without locking TrueTime\nMVCC needs timestamp. Since Spanner is a globally distributed system, we cannot use logical timestamp (otherwise, the centric timestamp manager can be the bottleneck), we also cannot use physical time (not accurate).\nTo resolve this problem, Spanner introduces TrueTime, which is a time range based on physical time instead of a single time point.\nThis time range can cover the error of physical clocks from different datacenters. We use GPS and atomic clocks to sync timestamp on different datacenters. So we can ensure the txn order without a centric timestamp manager.\nEvaluation Micro benchmark that shows the performance of replication, transactions and availability on a setup that the network distance between each other is less than 1ms. (A common layout, most apps do not need to distribute all data worldwide)\nAnalysis of a real world workload, F1.\nThe main takeaways A real cool system that shows how to combine techniques from different fields together. ","wordCount":"321","inLanguage":"en","datePublished":"2022-07-31T05:40:38Z","dateModified":"2024-12-28T14:09:27+08:00","author":{"@type":"Person","name":{"link":"https://github.com/z1ggy-o","name":"gyzhu"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://z1ggy-o.github.io/papers/2.c-2013-spanner/"},"publisher":{"@type":"Organization","name":"Gy's Blog","logo":{"@type":"ImageObject","url":"https://z1ggy-o.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://z1ggy-o.github.io/ accesskey=h title="Gy's Blog (Alt + H)">Gy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://z1ggy-o.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://z1ggy-o.github.io/weekly/ title=Logs><span>Logs</span></a></li><li><a href=https://z1ggy-o.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://z1ggy-o.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://z1ggy-o.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://z1ggy-o.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://z1ggy-o.github.io/papers/>Papers</a></div><h1 class="post-title entry-hint-parent">TOCS'13 - Spanner: Google’s Globally Distributed Database</h1><div class=post-meta><span title='2022-07-31 05:40:38 +0000 UTC'>July 31, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;map[link:https://github.com/z1ggy-o name:gyzhu]</div></header><div class=post-content><h2 id=motivation>Motivation<a hidden class=anchor aria-hidden=true href=#motivation>#</a></h2><ul><li><p>Some applications need relation data model and strong consistency which BigTable cannot gives.</p></li><li><p>So, Google want to develop a system that focuses on managing cross-datacenter replicate data with database features.</p></li></ul><h2 id=contribution>Contribution<a hidden class=anchor aria-hidden=true href=#contribution>#</a></h2><ul><li><p>Provides a globally distributed database that shards data across many sets of Paxos state machine in datacenters.</p></li><li><p>Provide SQL-like interface, strong consistency, and high read performance.</p></li></ul><h2 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h2><ul><li><p>Replication</p><ul><li>Use Paxos to replicate data to several nodes, which provides higher availability.</li></ul></li><li><p>Local Transactions (within a paxos group)</p><ul><li><p>Each Paxos group leader has a lock table to implement concurrency control.</p></li><li><p>Spanner chooses to use 2PL as the protocol because it is designed for long-lived txns, which performs poor under optimistic protocols.</p></li></ul></li><li><p>Distributed Transactions (across paxos groups)</p><ul><li><p>Each Paxos group leader has a transaction manager to support distributed txns.<br>The transaction manager is used as a participant leader.</p></li><li><p>Spanner uses 2PC to support distributed txns. Paxos group leaders become the coordinator and participants.</p></li></ul></li><li><p>Snapshot Isolation</p><ul><li>For better read performance, Spanner uses MVCC to enable read without locking</li></ul></li><li><p>TrueTime</p><ul><li><p>MVCC needs timestamp. Since Spanner is a globally distributed system, we cannot use logical timestamp (otherwise, the centric timestamp manager can be the bottleneck), we also cannot use physical time (not accurate).</p></li><li><p>To resolve this problem, Spanner introduces TrueTime, which is a time range based on physical time instead of a single time point.</p></li><li><p>This time range can cover the error of physical clocks from different datacenters. We use GPS and atomic clocks to sync timestamp on different datacenters. So we can ensure the txn order without a centric timestamp manager.</p></li></ul></li></ul><h2 id=evaluation>Evaluation<a hidden class=anchor aria-hidden=true href=#evaluation>#</a></h2><ul><li><p>Micro benchmark that shows the performance of replication, transactions and availability on a setup that the network distance between each other is less than 1ms. (A common layout, most apps do not need to distribute all data worldwide)</p></li><li><p>Analysis of a real world workload, F1.</p></li></ul><h2 id=the-main-takeaways>The main takeaways<a hidden class=anchor aria-hidden=true href=#the-main-takeaways>#</a></h2><ul><li>A real cool system that shows how to combine techniques from different fields together.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://z1ggy-o.github.io/tags/distributed-systems/>Distributed-Systems</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://z1ggy-o.github.io/>Gy's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>